wurstminestats
==============

Plotting the Wurstmineberg Minecraft Server

![Whitelist growth](http://i.wurstmineberg.de/wurstminestats/WhitelistGrowth.png)  
![Play Time](http://i.wurstmineberg.de/wurstminestats/sessions/playedPerMonthYear.png) 

## What this is
Primarily it's me playing around with [R](http://www.r-project.org).  
Besides that, this is an addition to the [wurstmineberg](http://wurstminebger.de) player statistics page at our [stats page](http://wurstminebger.de/stats). 

The public directory at [i.wurstmineberg.de/wurstminestats](http://i.wurstmineberg.de/wurstminestats/) is the place to go for up to date plots (hopefully). 
For everything else, I'd like to build a [shiny](http://shiny.rstudio.com/) version of wurstminestats, which should serve as a more convenient place to scroll through the data. Also, interactive plot with actual text would be nice, but finding a plotting library for the web that's comparable to `ggplot2` is pretty hard. Yes, I know about `ggvis`. No, there's no feature parity yet.

## Deployment
The plots are now generated by executing `genAll.R`on wurstmineberg.de via the `fcrontab` entry

    30 0,3,6,9,12,15,18,21 * * * /opt/hub/wurstmineberg/wurstminestats/genAll.R

…which, in theory, should update the plots every 3 hours at 30m past the hour, to reduce load on full hours caused by backup compression and whatnot.  

## Dependencies
Besides a recent version of R (duh), there are some things you need for this to be portable to any other Minecraft server. Let's go over the foreign data sources in this briefly.  

### Packages
#### The biggie: wurstmineR  
In an attempt to make this suck less, I moved most of the basic functionality from `functions.R`, along with the static `strings.*` data (see below) to it's own R package, primarily because I was curious how that would turn out.
As it turns out, it's pretty hard to do it right, but oh well.  
See [wurstmineR](https://github.com/jemus42/wurstmineR) for details. 
You need to install that via `devtools::install_github("jemus42/wurstmineR")`, which `dataPrep.R`does for you on startup. Or at least it should.  
Note that `wurstmineR` has it's own list of dependencies.

#### Other packages
* [twitteR](https://github.com/geoffjentry/twitteR) (Only required if you intend to fill a twitter account with random stats, see [@wurstminedata](https://twitter.com/wurstminedata) – Used in `tweetstats.R`)

### Data sources
* http://api.wurstmineberg.de/server/playerstats/general.json
* http://api.wurstmineberg.de/server/playerstats/achievement.json
* http://api.wurstmineberg.de/server/playerstats/item.json
* http://api.wurstmineberg.de/server/playerstats/entity.json  
* http://api.wurstmineberg.de/server/deaths/latest.json  
* http://api.wurstmineberg.de/server/sessions/overview.json  

These are [Minecraft API](http://api.wurstmineberg.de) endpoints, which expose the actual player statistics we're interested in visualising. If you have this set up for your own server, you're pretty much good to go. Almost.

### General information sources
* http://wurstmineberg.de/assets/serverstatus/people.json  

This is our [people database](http://wiki.wurstmineberg.de/People_file), which holds metadata about the people on our server, such as join date, nickname (ID), minecraft username and what have you. This is required to sort and classify the datasets. It is required in many dataset transformations, because I substitute minecraft usernames with their nicknames (IDs), sort them by join dates and group by their join status, so… If you don't want to set up a people.json, you'd need to get rid of these parts manually.

* http://assets.wurstmineberg.de/json/achievements.json

Just some substitution-friendly strings to make achievements more human readable.  

* http://assets.wurstmineberg.de/json/strings.json

Similar to achievements.json, this provides names and classification for player stats, as well as some mob name substitutions.

* http://assets.wurstmineberg.de/json/biomes.json

You guessed it. Contains biome ID, name if necessary and for this project the most relevant: Is the biome relevant to the [Adventuring Time](http://minecraft.gamepedia.com/Adventuring_Time#List_of_achievements) achievement or not. Used as a filter for the total amount of visited biomes per player and then put in [this](http://i.wurstmineberg.de/wurstminestats/achievements/exploreAllBiomesProgress.png).

* http://assets.wurstmineberg.de/json/items.json
  * also see http://assets.wurstmineberg.de/json/items.json.description.txt  

Like the other files, this is also used to substitute internal IDs with nicer names. More importantly, it contains both numeric and new IDs for each biome, which allows us to merge old, still numerically indexed item stats with current item stats. This will no longer be necessary when all the inactive players have finally logged in for once, but it's nice to be backwards compatible.  
Note that these files are already included in dataframe form in `wurstmineR`.

## Contribution
* If you're familiar with R or [ggplot2](http://docs.ggplot2.org/), I appreciate any hints on how to do something better, cleaner, more efficient or just more visually pleasing. 
* Requests for graphs are appreciated, and if I figure out how to make them happen, I will
* Visual errors in graphs can be reported via the issue tracker, you know, to keep track
* Errors with the data itself are more or less out of my reach.

